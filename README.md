# Gspread-Data-Tracker
Track changes in source data over time in Google Spreadsheets, for example the output of the importHtml command.

There is no GUI interface. Configuration is done through JSON configuration. Open the script editor in Google Spreadsheets, and load the Gspread-Data-Tracker library:

To use, go to Resources > Library in the Google Sheets script editor and enter the following project key: 
MlDapdgHJFiRpWKQOyZG0lIoHEfXZl5VD

Then enter the following text.
```javascript
spreadsheetsJson = []

function track() {
  TrackData.runDiffCheck(spreadsheetsJSON, false)
}
```

Then create a trigger to run the track() function repeatedly, as often as required.

Examples for spreadsheetJson coming...

JSON Spreadsheet Configuration Tables

Spreadsheet Object:


|    Attribute                      |    Type                            |    Default                                  |    Purpose                                                                                                                                                                                                                                                                                                                                     |
|-----------------------------------|------------------------------------|---------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    name                           |    String                          |    Required                                 |    Easily generate sheet names                                                                                                                                                                                                                                                                                                                 |
|    sources                        |    Array of source objects         |    Required                                 |    An array of external data sources which will be monitored (see   sources below)                                                                                                                                                                                                                                                             |
|    strings                        |    Array of strings                |    Use all defaults                         |                                                                                                                                                                                                                                                                                                                                                |
|    id                             |    String                          |    SpreadsheetApp.getActiveSpreadsheet()    |    The id of the spreadsheet to use. This can be found within the url:       https://docs.google.com/spreadsheets/d/1VJTPlM0pAMq3B3dGHcXk4rIDdrfIxWUcu8hZY67-LYw/                                                                                                                                                                              |
|    value_format                   |    String                          |    '@STRING@'                               |    Number format for the values, e.g.    value_format: '@STRING@' –   changing from default may stop the script from working                                                                                                                                                                                                                   |
|    date_format                    |    String                          |    'dd-MM-yyyy HH:mm'                       |    The date format which will be applied to all cells containing dates,   e.g.    'ddd dd MMMM yyyy HH:mm:ss'                                                                                                                                                                                                                                  |
|    mailto                         |    String                          |    false (no e-mail sent)                   |    An e-mail address or array of e-mail addresses to send an e-mail to   if anything changes.                                                                                                                                                                                                                                                  |
|    name_sources                   |    Array of name_source objects    |    {method: 0}    (for A1 notation)         |    An array of name_sources which will be used to find the cell name to   compare against. See name_sources object below. The output of each name   sources will be combined to make the final name.                                                                                                                                           |
|    Root                           |    Number                          |    0                                        |    Position in the Spreadsheet to start placing newly created sheets                                                                                                                                                                                                                                                                           |
|    exclude_if_any_header_empty    |    Bool                            |    false                                    |    If any of the name sources return an empty string, the cell will not   be monitored for changes                                                                                                                                                                                                                                             |
|    name_strip_replaces            |    Array                           |    []                                       |    List of javascript strip and replace commands to run on each cell   name                                                                                                                                                                                                                                                                    |
|    value_strip_replaces           |    Array                           |    []                                       |    List of javascript strip and replace commands to run on each cell   value                                                                                                                                                                                                                                                                   |
|    archive_time                   |    Number                          |    No archiving takes place.                |    Time, in minutes, after which the difference Sheet and history Sheet   will be archived and new sheets created.                                                                                                                                                                                                                             |
| range                             |    Array of 4 Numbers              |    sheet.getDataRange()                     |    The range of cells in the data sheet to monitor for changes. Format   is [firstRow, firstColumn, numRows, numColumns]. If numRows and numColumns   are set to 0 then getLastRow() or getLastColumn() will be run on the sheet to   get the number of rows or columns to use. Examples of acceptable values are   [1,1,2,1] or [1,1,0,0].    |
|    include_rows                   |    Array of numbers                |    All rows included                        |    An array of rows (relative to the range) to be monitored for changes.   All other rows will not be monitored.                                                                                                                                                                                                                               |
|    include_columns                |    Array of numbers                |    All rows included                        |    An array of columns (relative to the range) to be monitored or   changes. All other columns will not be monitored.                                                                                                                                                                                                                          |
|    exclude_rows                   |    Array of numbers                |    Empty                                    |    An array of rows (relative to the range) which will not be monitored   for changes.                                                                                                                                                                                                                                                         |
|    exclude_columns                |    Array of numbers                |    Empty                                    |    An array of rows (relative to the range) which will not be monitored   for changes.                                                                                                                                                                                                                                                         |
|    always_fill                    |    Bool                            |    false                                    |    If set to false, only cells who’s values have changed will appear in   new columns in the difference sheet. If true, all values will appear   regardless of if they changed or not.                                                                                                                                                         |
|    first_run                      |    Bool                            |    true                                     |    After the script has been run once and  the configuration has been verified, this   parameter can be set to false to reduce the number of Spreadsheet API   requests, helping the script to fun faster. Leave as true during testing and   troubleshooting.                                                                                 |
|    sort_diff_sheet                |    Bool                            |    false                                    |    If true; the difference sheet will be sorted by column A                                                                                                                                                                                                                                                                                    |
|    sort_history_sheet             |    Bool                            |    false                                    |    If true; the history sheet will be sorted by column A                                                                                                                                                                                                                                                                                       |
|    default_formatting             |    Bool                            |    true                                     |    If true, at the end the script will auto-resize all columns, headers   will be bolded and frozen, and sheets moved to appropriate positions; for   both the difference Sheet and the history Sheet                                                                                                                                          |

Strings Object:

|    Attribute                |    Type                  |    Purpose                      |    Default                                                                                                                |
|-----------------------------|--------------------------|---------------------------------|---------------------------------------------------------------------------------------------------------------------------|
|    data_sheet_name          |    String                |    name + '  Data'              |    Name of data sheet                                                                                                     |
|    diff_sheet_name          |    String                |    name + '  changes'           |    Name of changes sheet                                                                                                  |
|    diff_sheet_A1_header:    |    String                |    Equal to name                |    Entered in Cell A1 of the difference sheet                                                                             |
|    diff_sheet_B1_header     |    String                |    “Current Values”             |    Entered in Cell B1 of the difference sheet as header for the current   values                                          |
|    history_name             |    String                |    name + ' History'            |    Name of changes history sheet                                                                                          |
|    history_headers          |    Array of 3 strings    |    ['Date', 'Name', 'Value']    |    Header strings entered in A1, B1 and C1 of the history sheet                                                           |
|    removed_text             |    String                |    “No Longer Found”            |    Appears in a cell when a name belonging to a cell to be monitored can   no longer be found in the latest data sheet    |
|    subject                  |    String                |    name + ‘ has changed’        |    The subject for when a mail is sent                                                                                    |


