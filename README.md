# Gspread-Data-Tracker
Track changes in source data over time in Google Spreadsheets, for example the output of the importHtml command.

There is no GUI interface. Configuration is done through JSON configuration. Open the script editor in Google Spreadsheets, and load the Gspread-Data-Tracker library:

To use, go to Resources > Library in the Google Sheets script editor and enter the following project key: 
MlDapdgHJFiRpWKQOyZG0lIoHEfXZl5VD

Then enter the following text.
```javascript
spreadsheetsJson = []

function track() {
  TrackData.runDiffCheck(spreadsheetsJSON, false)
}
```

Then create a trigger to run the track() function repeatedly, as often as required.

Examples for spreadsheetJson coming...


|    Attribute                      |    Type                            |    Purpose                                                                                                                                                                                                                                                                                                                                     |    Default                                                                                                                       |   |
|-----------------------------------|------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|---|
|    name                           |    String                          |    Easily generate sheet names                                                                                                                                                                                                                                                                                                                 |    Required                                                                                                                      |   |
|    sources                        |    Array of source objects         |    An array of external data sources which will be monitored (see   sources below)                                                                                                                                                                                                                                                             |    Required                                                                                                                      |   |
|    id                             |    String                          |    The id of the spreadsheet to use. This can be found within the url:       https://docs.google.com/spreadsheets/d/1VJTPlM0pAMq3B3dGHcXk4rIDdrfIxWUcu8hZY67-LYw/                                                                                                                                                                              |    Output of SpreadsheetApp.getActiveSpreadsheet () method                                                                       |   |
|    diff_sheet_name                |    String                          |    Name of changes sheet                                                                                                                                                                                                                                                                                                                       |    name + '  changes'                                                                                                            |   |
|    diff_sheet_A1_header:          |    String                          |    Entered in Cell A1 of the difference sheet                                                                                                                                                                                                                                                                                                  |    Equal to name                                                                                                                 |   |
|    diff_sheet_B1_header           |    String                          |    Entered in Cell B1 of the difference sheet as header for the current   values                                                                                                                                                                                                                                                               |    “Current Values”                                                                                                              |   |
|    history_name                   |    String                          |    Name of changes history sheet                                                                                                                                                                                                                                                                                                               |    name + ' History'                                                                                                             |   |
|    history_headers                |    Array of 3 strings              |    Header strings entered in A1, B1 and C1 of the history sheet                                                                                                                                                                                                                                                                                |    ['Date', 'Name', 'Value']                                                                                                     |   |
|    data_sheet_name                |    String                          |    Name of the data sheet                                                                                                                                                                                                                                                                                                                      |    name + ' Data';                                                                                                               |   |
|    removed_text                   |    String                          |    Appears in a cell when a name belonging to a cell to be monitored can   no longer be found in the latest data sheet                                                                                                                                                                                                                         |    “No Longer Found”                                                                                                             |   |
|    value_format                   |    String                          |    Number format for the values, e.g.    value_format: '@STRING@'                                                                                                                                                                                                                                                                              |                                                                                                                                  |   |
|    date_format                    |    String                          |    The date format which will be applied to all cells containing dates,   e.g.    'ddd dd MMMM yyyy HH:mm:ss'                                                                                                                                                                                                                                  |    'dd-MM-yyyy HH:mm'                                                                                                            |   |
|    mailto                         |    String                          |    An e-mail address or array of e-mail addresses to send an e-mail to   if anything changes.                                                                                                                                                                                                                                                  |    false (no e-mail sent)                                                                                                        |   |
|    subject                        |    String                          |    The subject for when a mail is sent                                                                                                                                                                                                                                                                                                         |    name + ‘ has changed’                                                                                                         |   |
|    name_sources                   |    Array of name_source objects    |    An array of name_sources which will be used to find the cell name to   compare against. See name_sources object below. The output of each name sources   will be combined to make the final name.                                                                                                                                           |    {method: 0}    (for A1 notation)                                                                                              |   |
|    Root                           |    Number                          |    Position in the Spreadsheet to start placing newly created sheets                                                                                                                                                                                                                                                                           |    0                                                                                                                             |   |
|    exclude_if_any_header_empty    |    Bool                            |    If any of the name sources return an empty string, the cell will not   be monitored for changes                                                                                                                                                                                                                                             |    false                                                                                                                         |   |
|    split_name_by                  |    String or Regex                 |    After a name is compiled from the list of name sources, if this   parameter is set the split command will be run on the string:   name.split(split_name_by)[0]; to find the new name                                                                                                                                                        |    No string splitting on the name                                                                                               |   |
|    split_name_index               |    Number                          |    If split_name_by is set, this will be to index used to find the new   name, so the command will be run like this.   name.split(split_name_by)[split_name_index].   Ignored if split_name_by is not set.                                                                                                                                     |    0                                                                                                                             |   |
|    split_value_by                 |    String or Regex                 |    If set the split command will be run on each cell value:   value.split(split_value_by)[0]; to find the new name. Can be a string   or a regular expression, e.g. split_value_by: /\*/g,                                                                                                                                                     |    No name splitting takes place                                                                                                 |   |
|    split_value_index              |    Number                          |    If split_value_by is set, this will be to index used to find the new   value, so the command will be run like this.   name.split(split_value_by)[split_value_index].   Ignored if split_value_by is not set.                                                                                                                                |    0                                                                                                                             |   |
|    replace_in_value               |    String or Regex                 |    If set, the string or regex will be replaced by the value of   replace_in_value_with. This is run after the split command if split_name_by   is also set.                                                                                                                                                                                   |    false                                                                                                                         |   |
|    replace_in_value_with          |    String                          |    The string or regex in replace_in_value will be replaced with this   value. Default is an empty string, so the value being replaced will just be   removed.                                                                                                                                                                                 |    ‘’                                                                                                                            |   |
|    archive_time                   |    Number                          |    Time, in minutes, after which the difference Sheet and history Sheet   will be archived and new sheets created.                                                                                                                                                                                                                             |        No archiving takes place.                                                                                                 |   |
|    Range                          |    Array of 4 Numbers              |    The range of cells in the data sheet to monitor for changes. Format   is [firstRow, firstColumn, numRows, numColumns]. If numRows and numColumns   are set to 0 then getLastRow() or getLastColumn() will be run on the sheet to   get the number of rows or columns to use. Examples of acceptable values are   [1,1,2,1] or [1,1,0,0].    |    Output of sheet.getDataRange() command; the full range of cells   corresponding to the dimensions in which data is present    |   |
|    include_rows                   |    Array of numbers                |    An array of rows (relative to the range) to be monitored for changes.   All other rows will not be monitored.                                                                                                                                                                                                                               |    All rows included                                                                                                             |   |
|    include_columns                |    Array of numbers                |    An array of columns (relative to the range) to be monitored or   changes. All other columns will not be monitored.                                                                                                                                                                                                                          |    All rows included                                                                                                             |   |
|    exclude_rows                   |    Array of numbers                |    An array of rows (relative to the range) which will not be monitored   for changes.                                                                                                                                                                                                                                                         |    Empty                                                                                                                         |   |
|    exclude_columns                |    Array of numbers                |    An array of rows (relative to the range) which will not be monitored   for changes.                                                                                                                                                                                                                                                         |    Empty                                                                                                                         |   |
|    alwaysFill                     |    Bool                            |    If set to false, only cells who’s values have changed will appear in   new columns in the difference sheet. If true, all values will appear   regardless of if they changed or not.                                                                                                                                                         |    false                                                                                                                         |   |
|    first_run                      |    Bool                            |    After the script has been run once and  the configuration has been verified, this   parameter can be set to false to reduce the number of Spreadsheet API   requests, helping the script to fun faster. Leave as true during testing and   troubleshooting.                                                                                 |    true                                                                                                                          |   |
|    sort                           |    Bool                            |    If true; the difference sheet will be sorted by column A                                                                                                                                                                                                                                                                                    |    false                                                                                                                         |   |
|    default_formatting             |    Bool                            |    If true, at the end the script will auto-resize all columns, headers   will be bolded and frozen, and sheets moved to appropriate positions; for   both the difference Sheet and the history Sheet                                                                                                                                          |    true                                                                                                                          |   |
